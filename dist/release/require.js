var requirejs,require,define;(function(a){function i(a,b){var c,d,e,g,h,i,j,k,l,m,n=b&&b.split("/"),o=f.map,p=o&&o["*"]||{};if(a&&a.charAt(0)==="."&&b){n=n.slice(0,n.length-1),a=n.concat(a.split("/"));for(k=0;k<a.length;k+=1){m=a[k];if(m===".")a.splice(k,1),k-=1;else if(m==="..")if(k!==1||a[2]!==".."&&a[0]!=="..")k>0&&(a.splice(k-1,2),k-=2);else return!0}a=a.join("/")}if((n||p)&&o){c=a.split("/");for(k=c.length;k>0;k-=1){d=c.slice(0,k).join("/");if(n)for(l=n.length;l>0;l-=1){e=o[n.slice(0,l).join("/")];if(e){e=e[d];if(e){g=e,h=k;break}}}if(g)break;!i&&p&&p[d]&&(i=p[d],j=k)}!g&&i&&(g=i,h=j),g&&(c.splice(0,h,g),a=c.join("/"))}return a}function j(b,d){return function(){return c.apply(a,h.call(arguments,0).concat([b,d]))}}function k(a){return function(b){return i(b,a)}}function l(a){return function(b){d[a]=b}}function m(c){if(e.hasOwnProperty(c)){var f=e[c];delete e[c],g[c]=!0,b.apply(a,f)}if(!d.hasOwnProperty(c))throw new Error("No "+c);return d[c]}function n(a,b){var c,d,e=a.indexOf("!");return e!==-1?(c=i(a.slice(0,e),b),a=a.slice(e+1),d=m(c),d&&d.normalize?a=d.normalize(a,k(b)):a=i(a,b)):a=i(a,b),{f:c?c+"!"+a:a,n:a,p:d}}function o(a){return function(){return f&&f.config&&f.config[a]||{}}}var b,c,d={},e={},f={},g={},h=[].slice;b=function(b,c,f,h){var i,k,p,q,r,s=[],t;h=h||b;if(typeof f=="function"){c=!c.length&&f.length?["require","exports","module"]:c;for(r=0;r<c.length;r+=1){q=n(c[r],h),k=q.f;if(k==="require")s[r]=j(b);else if(k==="exports")s[r]=d[b]={},t=!0;else if(k==="module")i=s[r]={id:b,uri:"",exports:d[b],config:o(b)};else if(d.hasOwnProperty(k)||e.hasOwnProperty(k))s[r]=m(k);else if(q.p)q.p.load(q.n,j(h,!0),l(k),{}),s[r]=d[k];else if(!g[k])throw new Error(b+" missing "+k)}p=f.apply(d[b],s);if(b)if(i&&i.exports!==a&&i.exports!==d[b])d[b]=i.exports;else if(p!==a||!t)d[b]=p}else b&&(d[b]=f)},requirejs=require=c=function(d,e,g,h,i){return typeof d=="string"?m(n(d,e).f):(d.splice||(f=d,e.splice?(d=e,e=g,g=null):d=a),e=e||function(){},typeof g=="function"&&(g=h,h=i),h?b(a,d,e,g):setTimeout(function(){b(a,d,e,g)},15),c)},c.config=function(a){return f=a,c},define=function(a,b,c){b.splice||(c=b,b=[]),e[a]=[a,b,c]},define.amd={jQuery:!0}})(),function(a,b){function c(a){return new d(a)}function d(a){if(a&&a._wrapped)return a;this._wrapped=a}function e(a,b,c){b||(b=0);var d=a.length,e=d-b>=(c||30),f=e?{}:a;if(e){var g,h=b-1;while(++h<d)g=a[h]+"",(bU.call(f,g)?f[g]:f[g]=[]).push(a[h])}return function(a){if(e){var c=a+"";return bU.call(f,c)&&v(f[c],a)>-1}return v(f,a,b)>-1}}function f(){var a,b,c,d=-1,e=arguments.length,f={bottom:"",exit:"",init:"",top:"",arrayBranch:{beforeLoop:""},objectBranch:{beforeLoop:""}};while(++d<e){a=arguments[d];for(b in a)c=(c=a[b])==null?"":c,/beforeLoop|inLoop/.test(b)?(typeof c=="string"&&(c={array:c,object:c}),f.arrayBranch[b]=c.array,f.objectBranch[b]=c.object):f[b]=c}var h=f.args,i=/^[^,]+/.exec(h)[0];f.firstArg=i,f.hasDontEnumBug=ck,f.isKeysFast=co,f.shadowed=bP,f.useHas=f.useHas!==!1,f.useStrict=f.useStrict!==!1,"noCharByIndex"in f||(f.noCharByIndex=cm),f.exit||(f.exit="if (!"+i+") return result");if(i!="collection"||!f.arrayBranch.inLoop)f.arrayBranch=null;var j=Function("arrayClass, bind, compareAscending, funcClass, hasOwnProperty, identity, iteratorBind, objectTypes, nativeKeys, propertyIsEnumerable, slice, stringClass, toString","return function("+h+") {\n"+cu(f)+"\n}");return j(cb,M,g,ce,bU,bm,k,cs,ca,bW,bX,ch,bY)}function g(a,c){return a=a.criteria,c=c.criteria,a===b?1:c===b?-1:a<c?-1:a>c?1:0}function h(a,b){return bS[b]}function i(a){return"\\"+ct[a]}function j(a){return cr[a]}function k(a,b){return function(c,d,e){return a.call(b,c,d,e)}}function l(){}function m(a,b){if(bG.test(b))return"<e%-"+b+"%>";var c=bS.length;return bS[c]="' +\n__e("+b+") +\n'",bR+c}function n(a,b,c,d){var e=bS.length;return b?bS[e]="';\n"+b+";\n__p += '":c?bS[e]="' +\n__e("+c+") +\n'":d&&(bS[e]="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"),bR+e}function o(a,b){if(bG.test(b))return"<e%="+b+"%>";var c=bS.length;return bS[c]="' +\n((__t = ("+b+")) == null ? '' : __t) +\n'",bR+c}function p(a,b,c,d){if(!a)return c;var e=a.length,f=arguments.length<3;d&&(b=k(b,d));if(e===e>>>0){var g=cm&&bY.call(a)==ch?a.split(""):a;e&&f&&(c=g[--e]);while(e--)c=b(c,g[e],e,a);return c}var h,i=cZ(a);e=i.length,e&&f&&(c=a[i[--e]]);while(e--)h=i[e],c=b(c,a[h],h,a);return c}function q(a){if(!a)return[];if(a.toArray&&bY.call(a.toArray)==ce)return a.toArray();var b=a.length;return b===b>>>0?(cl?bY.call(a)==ch:typeof a=="string")?a.split(""):bX.call(a):c$(a)}function r(a){var b=[];if(!a)return b;var c=-1,d=a.length;while(++c<d)a[c]&&b.push(a[c]);return b}function s(a){var b=[];if(!a)return b;var c=-1,d=a.length,f=bT.apply(b,arguments),g=e(f,d);while(++c<d)g(a[c])||b.push(a[c]);return b}function t(a,b,c){if(a)return b==null||c?a[0]:bX.call(a,0,b)}function u(a,b){var c=[];if(!a)return c;var d,e=-1,f=a.length;while(++e<f)d=a[e],cX(d)?bV.apply(c,b?d:u(d)):c.push(d);return c}function v(a,b,c){if(!a)return-1;var d=-1,e=a.length;if(c){if(typeof c!="number")return d=F(a,b),a[d]===b?d:-1;d=(c<0?Math.max(0,e+c):c)-1}while(++d<e)if(a[d]===b)return d;return-1}function w(a,b,c){return a?bX.call(a,0,-(b==null||c?1:b)):[]}function x(a){var b=[];if(!a)return b;var c,d=-1,f=a.length,g=bX.call(arguments,1),h=[];while(++d<f)c=a[d],v(b,c)<0&&cE(g,function(a,b){return(h[b]||(h[b]=e(a)))(c)})&&b.push(c);return b}function y(a,b,c){if(a){var d=a.length;return b==null||c?a[d-1]:bX.call(a,-b||d)}}function z(a,b,c){if(!a)return-1;var d=a.length;c&&typeof c=="number"&&(d=(c<0?Math.max(0,d+c):Math.min(c,d-1))+1);while(d--)if(a[d]===b)return d;return-1}function A(a,b,c){var d=-Infinity,e=d;if(!a)return e;var f,g=-1,h=a.length;if(!b){while(++g<h)a[g]>e&&(e=a[g]);return e}c&&(b=k(b,c));while(++g<h)f=b(a[g],g,a),f>d&&(d=f,e=a[g]);return e}function B(a,b,c){var d=Infinity,e=d;if(!a)return e;var f,g=-1,h=a.length;if(!b){while(++g<h)a[g]<e&&(e=a[g]);return e}c&&(b=k(b,c));while(++g<h)f=b(a[g],g,a),f<d&&(d=f,e=a[g]);return e}function C(a,b,c){c||(c=1),b==null&&(b=a||0,a=0);var d=-1,e=Math.max(0,Math.ceil((b-a)/c)),f=Array(e);while(++d<e)f[d]=a,a+=c;return f}function D(a,b,c){return a?bX.call(a,b==null||c?1:b):[]}function E(a){if(!a)return[];var b,c=-1,d=a.length,e=Array(d);while(++c<d)b=Math.floor(Math.random()*(c+1)),e[c]=e[b],e[b]=a[c];return e}function F(a,b,c,d){if(!a)return 0;var e,f=0,g=a.length;if(c){d&&(c=M(c,d)),b=c(b);while(f<g)e=f+g>>>1,c(a[e])<b?f=e+1:g=e}else while(f<g)e=f+g>>>1,a[e]<b?f=e+1:g=e;return f}function G(){var a=-1,b=[],c=bT.apply(b,arguments),d=c.length;while(++a<d)v(b,c[a])<0&&b.push(c[a]);return b}function H(a,b,c,d){var e=[];if(!a)return e;var f,g=-1,h=a.length,i=[];typeof b=="function"&&(d=c,c=b,b=!1),c?d&&(c=k(c,d)):c=bm;while(++g<h){f=c(a[g],g,a);if(b?!g||i[i.length-1]!==f:v(i,f)<0)i.push(f),e.push(a[g])}return e}function I(a){var b=[];if(!a)return b;var c=-1,d=a.length,f=e(arguments,1,20);while(++c<d)f(a[c])||b.push(a[c]);return b}function J(a){if(!a)return[];var b=-1,c=A(cL(arguments,"length")),d=Array(c);while(++b<c)d[b]=cL(arguments,b);return d}function K(a,b){if(!a)return{};var c=-1,d=a.length,e={};b||(b=[]);while(++c<d)e[a[c]]=b[c];return e}function L(a,b){return a<1?b():function(){if(--a<1)return b.apply(this,arguments)}}function M(a,b){function c(){var g=arguments,h=b;e||(a=b[d]),f.length&&(g=g.length?bT.apply(f,g):f);if(this instanceof c){l.prototype=a.prototype,h=new l;var i=a.apply(h,g);return i&&cs[typeof i]?i:h}return a.apply(h,g)}var d,e=bY.call(a)==ce;if(!e)d=b,b=a;else if(cn||bZ&&arguments.length>2)return bZ.call.apply(bZ,arguments);var f=bX.call(arguments,2);return c}function N(){var a=arguments;return function(){var b=arguments,c=a.length;while(c--)b=[a[c].apply(this,b)];return b[0]}}function O(a,b,c){function d(){h=null,c||a.apply(g,e)}var e,f,g,h;return function(){var i=c&&!h;return e=arguments,g=this,ci(h),h=cj(d,b),i&&(f=a.apply(g,e)),f}}function P(a,c){var d=bX.call(arguments,2);return cj(function(){return a.apply(b,d)},c)}function Q(a){var c=bX.call(arguments,1);return cj(function(){return a.apply(b,c)},1)}function R(a,b){var c={};return function(){var d=b?b.apply(this,arguments):arguments[0];return bU.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}}function S(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),b)}}function T(a){var b=bX.call(arguments,1),c=b.length;return function(){var d,e=arguments;return e.length&&(b.length=c,bV.apply(b,e)),d=b.length==1?a.call(this,b[0]):a.apply(this,b),b.length=c,d}}function U(a,b){function c(){h=new Date,g=null,a.apply(f,d)}var d,e,f,g,h=0;return function(){var i=new Date,j=b-(i-h);return d=arguments,f=this,j<=0?(h=i,e=a.apply(f,d)):g||(g=cj(c,j)),e}}function V(a,b){return function(){var c=[a];return arguments.length&&bV.apply(c,arguments),b.apply(this,c)}}function W(a){return a&&cs[typeof a]?cX(a)?a.slice():cS({},a):a}function X(a,b){return bU.call(a,b)}function Y(a){return a===!0||a===!1||bY.call(a)==cc}function Z(a){return bY.call(a)==cd}function $(a){return!!a&&a.nodeType==1}function _(a,b,c){c||(c=[]);if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&bY.call(a.isEqual)==ce)return a.isEqual(b);if(b.isEqual&&bY.call(b.isEqual)==ce)return b.isEqual(a);var d=bY.call(a);if(d!=bY.call(b))return!1;switch(d){case ch:return a==String(b);case cf:return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case cc:case cd:return+a==+b;case cg:return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;var f=-1,g=!0,h=0;c.push(a);if(d==cb){h=a.length,g=h==b.length;if(g)while(h--)if(!(g=_(a[h],b[h],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var i in a)if(bU.call(a,i)){h++;if(!(g=bU.call(b,i)&&_(a[i],b[i],c)))break}if(g){for(i in b)if(bU.call(b,i)&&!(h--))break;g=!h}if(g&&ck)while(++f<7){i=bP[f];if(bU.call(a,i)&&!(g=bU.call(b,i)&&_(a[i],b[i],c)))break}}return c.pop(),g}function ba(a){return b_(a)&&bY.call(a)==cf}function bb(a){return bY.call(a)==ce}function bc(a){return a&&cs[typeof a]}function bd(a){return bY.call(a)==cf&&a!=+a}function be(a){return a===null}function bf(a){return bY.call(a)==cf}function bg(a){return bY.call(a)==cg}function bh(a){return bY.call(a)==ch}function bi(a){return a===b}function bj(a){var b,c=0,d=bT.apply(bC,arguments),e=d.length,f={};while(++c<e)b=d[c],b in a&&(f[b]=a[b]);return f}function bk(a){if(!a)return 0;var b=a.length;return b===b>>>0?a.length:cZ(a).length}function bl(a){return a==null?"":(a+"").replace(bN,j)}function bm(a){return a}function bn(a){cH(cV(a),function(b){var e=c[b]=a[b];d.prototype[b]=function(){var a=[this._wrapped];arguments.length&&bV.apply(a,arguments);var b=e.apply(c,a);return this._chain&&(b=new d(b),b._chain=!0),b}})}function bo(){return a._=bF,this}function bp(a,b){if(!a)return null;var c=a[b];return bY.call(c)==ce?a[b]():c}function bq(a,b,d){d||(d={});var e,f,g=d.escape,j=d.evaluate,k=d.interpolate,l=c.templateSettings,p=d.variable;g==null&&(g=l.escape),j==null&&(j=l.evaluate),k==null&&(k=l.interpolate),g&&(a=a.replace(g,m)),k&&(a=a.replace(k,o)),j!=bx&&(bx=j,bA=RegExp((j?j.source:"($^)")+"|<e%-([\\s\\S]+?)%>|<e%=([\\s\\S]+?)%>","g")),e=bS.length,a=a.replace(bA,n),e=e!=bS.length,a="__p += '"+a.replace(bO,i).replace(bM,h)+"';\n",bS.length=0,p||(p=l.variable||by||"obj",e?a="with ("+p+") {\n"+a+"\n}\n":(p!=by&&(by=p,bz=RegExp("(\\(\\s*)"+p+"\\."+p+"\\b","g")),a=a.replace(bK,"$&"+p+".").replace(bz,"$1__d"))),a=(e?a.replace(bH,""):a).replace(bI,"$1").replace(bJ,"$1;"),a="function("+p+") {\n"+p+" || ("+p+" = {});\n"+"var __t, __p = '', __e = _.escape"+(e?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":", __d = "+p+"."+p+" || "+p+";\n")+a+"return __p\n}",cp&&(a+="\n//@ sourceURL=/lodash/template/source["+bQ++ +"]");try{f=Function("_","return "+a)(c)}catch(q){f=function(){throw q}}return b?f(b):(f.source=a,f)}function br(a,b,c){var d=-1;if(c)while(++d<a)b.call(c,d);else while(++d<a)b(d)}function bs(a){var b=bE++;return a?a+b:b}function bt(a){return a=new d(a),a._chain=!0,a}function bu(a,b){return b(a),a}function bv(){return this._chain=!0,this}function bw(){return this._wrapped}var bx,by,bz,bA,bB=typeof exports=="object"&&exports&&(typeof global=="object"&&global&&global==global.global&&(a=global),exports),bC=Array.prototype,bD=Object.prototype,bE=0,bF=a._,bG=/[-+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,bH=/\b__p \+= '';/g,bI=/\b(__p \+=) '' \+/g,bJ=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bK=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,bL=RegExp("^"+(bD.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),bM=/__token__(\d+)/g,bN=/[&<"']/g,bO=/['\n\r\t\u2028\u2029\\]/g,bP=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],bQ=0,bR="__token__",bS=[],bT=bC.concat,bU=bD.hasOwnProperty,bV=bC.push,bW=bD.propertyIsEnumerable,bX=bC.slice,bY=bD.toString,bZ=bL.test(bZ=bX.bind)&&bZ,b$=bL.test(b$=Array.isArray)&&b$,b_=a.isFinite,ca=bL.test(ca=Object.keys)&&ca,cb="[object Array]",cc="[object Boolean]",cd="[object Date]",ce="[object Function]",cf="[object Number]",cg="[object RegExp]",ch="[object String]",ci=a.clearTimeout,cj=a.setTimeout,ck=!bW.call({valueOf:0},"valueOf"),cl=bX.call("x")[0]!="x",cm="x"[0]+Object("x")[0]!="xx",cn=bZ&&/\n|Opera/.test(bZ+bY.call(a.opera)),co=ca&&/^.+$|true/.test(ca+!!a.attachEvent);try{var cp=(Function("//@")(),!0)}catch(cq){}var cr={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#x27;"},cs={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},ct={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"};c.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:"obj"};var cu=bq("<% if (useStrict) { %>'use strict';\n<% } %>var index, iteratee = <%= firstArg %>, result<% if (init) { %> = <%= init %><% } %>;\n<%= exit %>;\n<%= top %>;\n<% if (arrayBranch) { %>var length = iteratee.length; index = -1;  <% if (objectBranch) { %>\nif (length === length >>> 0) {<% } %>  <% if (noCharByIndex) { %>\n  if (toString.call(iteratee) == stringClass) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  <%= arrayBranch.beforeLoop %>;\n  while (++index < length) {\n    <%= arrayBranch.inLoop %>\n  }  <% if (objectBranch) { %>\n}<% } %><% } %><% if (objectBranch) { %>  <% if (arrayBranch) { %>\nelse {<% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var props = nativeKeys(iteratee),\n      propIndex = -1,\n      length = props.length;\n\n  <%= objectBranch.beforeLoop %>;\n  while (++propIndex < length) {\n    index = props[propIndex];\n    if (!(skipProto && index == 'prototype')) {\n      <%= objectBranch.inLoop %>\n    }\n  }  <% } else { %>\n  <%= objectBranch.beforeLoop %>;\n  for (index in iteratee) {    <% if (hasDontEnumBug) { %>\n    <%   if (useHas) { %>if (hasOwnProperty.call(iteratee, index)) {\n  <% } %>    <%= objectBranch.inLoop %>;\n    <%   if (useHas) { %>}<% } %>    <% } else { %>\n    if (!(skipProto && index == 'prototype')<% if (useHas) { %> &&\n        hasOwnProperty.call(iteratee, index)<% } %>) {\n      <%= objectBranch.inLoop %>\n    }    <% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    <%= objectBranch.inLoop %>\n  }    <% } %>  <% } %>  <% if (arrayBranch) { %>\n}<% } %><% } %>\n<%= bottom %>;\nreturn result"),cv={args:"collection, callback, thisArg",init:"collection",top:"if (!callback) {\n  callback = identity\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:"callback(iteratee[index], index, collection)"},cw={init:"true",inLoop:"if (!callback(iteratee[index], index, collection)) return !result"},cx={useHas:!1,useStrict:!1,args:"object",init:"object",top:"for (var iterateeIndex = 1, length = arguments.length; iterateeIndex < length; iterateeIndex++) {\n  iteratee = arguments[iterateeIndex];\n"+(ck?"  if (iteratee) {":""),inLoop:"result[index] = iteratee[index]",bottom:(ck?"  }\n":"")+"}"},cy={init:"[]",inLoop:"callback(iteratee[index], index, collection) && result.push(iteratee[index])"},cz={top:"if (thisArg) callback = iteratorBind(callback, thisArg)"},cA={inLoop:{object:cv.inLoop}},cB={init:"",exit:"if (!collection) return []",beforeLoop:{array:"result = Array(length)",object:"result = "+(co?"Array(length)":"[]")},inLoop:{array:"result[index] = callback(iteratee[index], index, collection)",object:"result"+(co?"[propIndex] = ":".push")+"(callback(iteratee[index], index, collection))"}},cC=f({args:"object",exit:"if (!(object && objectTypes[typeof object])) throw TypeError()",init:"[]",inLoop:"result.push(index)"}),cD=f({args:"collection, target",init:"false",noCharByIndex:!1,beforeLoop:{array:"if (toString.call(iteratee) == stringClass) return collection.indexOf(target) > -1"},inLoop:"if (iteratee[index] === target) return true"}),cE=f(cv,cw),cF=f(cv,cy),cG=f(cv,cz,{init:"",inLoop:"if (callback(iteratee[index], index, collection)) return iteratee[index]"}),cH=f(cv,cz),cI=f(cv,{init:"{}",top:"var prop, isFunc = typeof callback == 'function';\nif (isFunc && thisArg) callback = iteratorBind(callback, thisArg)",inLoop:"prop = isFunc\n  ? callback(iteratee[index], index, collection)\n  : iteratee[index][callback];\n(hasOwnProperty.call(result, prop) ? result[prop] : result[prop] = []).push(iteratee[index])"}),cJ=f(cB,{args:"collection, methodName",top:"var args = slice.call(arguments, 2),\n    isFunc = typeof methodName == 'function'",inLoop:{array:"result[index] = (isFunc ? methodName : iteratee[index][methodName]).apply(iteratee[index], args)",object:"result"+(co?"[propIndex] = ":".push")+"((isFunc ? methodName : iteratee[index][methodName]).apply(iteratee[index], args))"}}),cK=f(cv,cB),cL=f(cB,{args:"collection, property",inLoop:{array:"result[index] = iteratee[index][property]",object:"result"+(co?"[propIndex] = ":".push")+"(iteratee[index][property])"}}),cM=f({args:"collection, callback, accumulator, thisArg",init:"accumulator",top:"var noaccum = arguments.length < 3;\nif (thisArg) callback = iteratorBind(callback, thisArg)",beforeLoop:{array:"if (noaccum) result = collection[++index]"},inLoop:{array:"result = callback(result, iteratee[index], index, collection)",object:"result = noaccum\n  ? (noaccum = false, iteratee[index])\n  : callback(result, iteratee[index], index, collection)"}}),cN=f(cv,cy,{inLoop:"!"+cy.inLoop}),cO=f(cv,cw,{init:"false",inLoop:cw.inLoop.replace("!","")}),cP=f(cv,cB,{top:"if (typeof callback == 'string') {\n  var prop = callback;\n  callback = function(collection) { return collection[prop] }\n}\nelse if (thisArg) {\n  callback = iteratorBind(callback, thisArg)\n}",inLoop:{array:"result[index] = {\n  criteria: callback(iteratee[index], index, collection),\n  value: iteratee[index]\n}",object:"result"+(co?"[propIndex] = ":".push")+"({\n"+"  criteria: callback(iteratee[index], index, collection),\n"+"  value: iteratee[index]\n"+"})"},bottom:"result.sort(compareAscending);\nlength = result.length;\nwhile (length--) {\n  result[length] = result[length].value\n}"}),cQ=f({useHas:!1,useStrict:!1,args:"object",init:"object",top:"var funcs = arguments,\n    length = funcs.length;\nif (length > 1) {\n  for (var index = 1; index < length; index++)\n    result[funcs[index]] = bind(result[funcs[index]], result);\n  return result\n}",inLoop:"if (toString.call(result[index]) == funcClass) result[index] = bind(result[index], result)"}),cR=f(cx,{inLoop:"if (result[index] == null) "+cx.inLoop}),cS=f(cx),cT=f(cv,cz,cA,{useHas:!1}),cU=f(cv,cz,cA),cV=f({useHas:!1,args:"object",init:"[]",inLoop:"if (toString.call(iteratee[index]) == funcClass) result.push(index)",bottom:"result.sort()"}),cW=function(a){return bY.call(a)=="[object Arguments]"};cW(arguments)||(cW=function(a){return!!a&&!!bU.call(a,"callee")});var cX=b$||function(a){return bY.call(a)==cb},cY=f({args:"value",init:"true",top:"var className = toString.call(value);\nif (className == arrayClass || className == stringClass) return !value.length",inLoop:{object:"return false"}}),cZ=ca?function(a){return typeof a=="function"&&bW.call(a,"prototype")?cC(a):ca(a)}:cC,c$=f({args:"object",init:"[]",inLoop:"result.push(iteratee[index])"});c.VERSION="0.4.2",c.after=L,c.bind=M,c.bindAll=cQ,c.chain=bt,c.clone=W,c.compact=r,c.compose=N,c.contains=cD,c.debounce=O,c.defaults=cR,c.defer=Q,c.delay=P,c.difference=s,c.escape=bl,c.every=cE,c.extend=cS,c.filter=cF,c.find=cG,c.first=t,c.flatten=u,c.forEach=cH,c.forIn=cT,c.forOwn=cU,c.functions=cV,c.groupBy=cI,c.has=X,c.identity=bm,c.indexOf=v,c.initial=w,c.intersection=x,c.invoke=cJ,c.isArguments=cW,c.isArray=cX,c.isBoolean=Y,c.isDate=Z,c.isElement=$,c.isEmpty=cY,c.isEqual=_,c.isFinite=ba,c.isFunction=bb,c.isNaN=bd,c.isNull=be,c.isNumber=bf,c.isObject=bc,c.isRegExp=bg,c.isString=bh,c.isUndefined=bi,c.keys=cZ,c.last=y,c.lastIndexOf=z,c.map=cK,c.max=A,c.memoize=R,c.min=B,c.mixin=bn,c.noConflict=bo,c.once=S,c.partial=T,c.pick=bj,c.pluck=cL,c.range=C,c.reduce=cM,c.reduceRight=p,c.reject=cN,c.rest=D,c.result=bp,c.shuffle=E,c.size=bk,c.some=cO,c.sortBy=cP,c.sortedIndex=F,c.tap=bu,c.template=bq,c.throttle=U,c.times=br,c.toArray=q,c.union=G,c.uniq=H,c.uniqueId=bs,c.values=c$,c.without=I,c.wrap=V,c.zip=J,c.zipObject=K,c.all=cE,c.any=cO,c.collect=cK,c.detect=cG,c.each=cH,c.foldl=cM,c.foldr=p,c.head=t,c.include=cD,c.inject=cM,c.methods=cV,c.select=cF,c.tail=D,c.take=t,c.unique=H,c._iteratorTemplate=cu,c._shimKeys=cC,d.prototype=c.prototype,bn(c),d.prototype.chain=bv,d.prototype.value=bw,cH(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=bC[a];d.prototype[a]=function(){var a=this._wrapped;return b.apply(a,arguments),a.length===0&&delete a[0],this._chain&&(a=new d(a),a._chain=!0),a}}),cH(["concat","join","slice"],function(a){var b=bC[a];d.prototype[a]=function(){var a=this._wrapped,c=b.apply(a,arguments);return this._chain&&(c=new d(c),c._chain=!0),c}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(a._=c,define("underscore",[],function(){return c})):bB?typeof module=="object"&&module&&module.exports==bB?(module.exports=c)._=c:bB._=c:a._=c}(this),function(){var a=this,b=a.Backbone,c=Array.prototype.splice,d;typeof exports!="undefined"?d=exports:d=a.Backbone={},d.VERSION="0.9.2";var e=a._;!e&&typeof require!="undefined"&&(e=require("underscore")),d.$=a.jQuery||a.Zepto||a.ender,d.noConflict=function(){return a.Backbone=b,this},d.emulateHTTP=!1,d.emulateJSON=!1;var f=/\s+/,g=d.Events={on:function(a,b,c){var d,e,g;if(!b)return this;a=a.split(f),d=this._callbacks||(this._callbacks={});while(e=a.shift())g=d[e]||(d[e]=[]),g.push(b,c);return this},off:function(a,b,c){var d,g,h,i;if(!(g=this._callbacks))return this;if(!(a||b||c))return delete this._callbacks,this;a=a?a.split(f):e.keys(g);while(d=a.shift()){if(!(h=g[d])||!b&&!c){delete g[d];continue}for(i=h.length-2;i>=0;i-=2)b&&h[i]!==b||c&&h[i+1]!==c||h.splice(i,2)}return this},trigger:function(a){var b,c,d,e,g,h,i,j;if(!(c=this._callbacks))return this;j=[],a=a.split(f);for(e=1,g=arguments.length;e<g;e++)j[e-1]=arguments[e];while(b=a.shift()){if(i=c.all)i=i.slice();if(d=c[b])d=d.slice();if(d)for(e=0,g=d.length;e<g;e+=2)d[e].apply(d[e+1]||this,j);if(i){h=[b].concat(j);for(e=0,g=i.length;e<g;e+=2)i[e].apply(i[e+1]||this,h)}}return this}};g.bind=g.on,g.unbind=g.off;var h=d.Model=function(a,b){var c;a||(a={}),b&&b.collection&&(this.collection=b.collection),b&&b.parse&&(a=this.parse(a));if(c=z(this,"defaults"))a=e.extend({},c,a);this.attributes={},this._escapedAttributes={},this.cid=e.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(a,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=e.clone(this.attributes),this.initialize.apply(this,arguments)};e.extend(h.prototype,g,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return e.clone(this.attributes)},sync:function(){return d.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.get(a);return this._escapedAttributes[a]=e.escape(c==null?"":""+c)},has:function(a){return this.get(a)!=null},set:function(a,b,c){var d,f,g;e.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c||(c={});if(!d)return this;d instanceof h&&(d=d.attributes);if(c.unset)for(f in d)d[f]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var i=c.changes={},j=this.attributes,k=this._escapedAttributes,l=this._previousAttributes||{};for(f in d){g=d[f];if(!e.isEqual(j[f],g)||c.unset&&e.has(j,f))delete k[f],(c.silent?this._silent:i)[f]=!0;c.unset?delete j[f]:j[f]=g,!e.isEqual(l[f],g)||e.has(j,f)!==e.has(l,f)?(this.changed[f]=g,c.silent||(this._pending[f]=!0)):(delete this.changed[f],delete this._pending[f])}return c.silent||this.change(c),this},unset:function(a,b){return b=e.extend({},b,{unset:!0}),this.set(a,null,b)},clear:function(a){return a=e.extend({},a,{unset:!0}),this.set(e.clone(this.attributes),a)},fetch:function(a){a=a?e.clone(a):{};var b=this,c=a.success;return a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d,a),b.trigger("sync",b,d,a)},a.error=d.wrapError(a.error,b,a),this.sync("read",this,a)},save:function(a,b,c){var f,g,h;e.isObject(a)||a==null?(f=a,c=b):(f={},f[a]=b),c=c?e.clone(c):{};if(c.wait){if(!this._validate(f,c))return!1;g=e.clone(this.attributes)}var i=e.extend({},c,{silent:!0});if(f&&!this.set(f,c.wait?i:c))return!1;if(!f&&!this.isValid())return!1;var j=this,k=c.success;c.success=function(a,b,d){h=!0;var g=j.parse(a,d);c.wait&&(g=e.extend(f||{},g));if(!j.set(g,c))return!1;k&&k(j,a,c),j.trigger("sync",j,a,c)},c.error=d.wrapError(c.error,j,c);var l=this.sync(this.isNew()?"create":"update",this,c);return!h&&c.wait&&(this.clear(i),this.set(g,i)),l},destroy:function(a){a=a?e.clone(a):{};var b=this,c=a.success,f=function(){b.trigger("destroy",b,b.collection,a)};a.success=function(d){(a.wait||b.isNew())&&f(),c&&c(b,d,a),b.isNew()||b.trigger("sync",b,d,a)};if(this.isNew())return a.success(),!1;a.error=d.wrapError(a.error,b,a);var g=this.sync("delete",this,a);return a.wait||f(),g},url:function(){var a=z(this,"urlRoot")||z(this.collection,"url")||A();return this.isNew()?a:a+(a.charAt(a.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(a){a||(a={});var b=this._changing;this._changing=!0;for(var c in this._silent)this._pending[c]=!0;var d=e.extend({},a.changes,this._silent);this._silent={};for(var c in d)this.trigger("change:"+c,this,this.get(c),a);if(b)return this;while(!e.isEmpty(this._pending)){this._pending={},this.trigger("change",this,a);for(var c in this.changed){if(this._pending[c]||this._silent[c])continue;delete this.changed[c]}this._previousAttributes=e.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(a){return a==null?!e.isEmpty(this.changed):e.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?e.clone(this.changed):!1;var b,c=!1,d=this._previousAttributes;for(var f in a){if(e.isEqual(d[f],b=a[f]))continue;(c||(c={}))[f]=b}return c},previous:function(a){return a==null||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return e.clone(this._previousAttributes)},isValid:function(){return!this.validate||!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;a=e.extend({},this.attributes,a);var c=this.validate(a,b);return c?(b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}});var i=d.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),b.comparator!==void 0&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,{silent:!0,parse:b.parse})};e.extend(i.prototype,g,{model:h,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return d.sync.apply(this,arguments)},add:function(a,b){var d,f,g,h,i,j,k={},l={},m=[];b||(b={}),a=e.isArray(a)?a.slice():[a];for(d=0,g=a.length;d<g;d++){if(!(h=a[d]=this._prepareModel(a[d],b)))throw new Error("Can't add an invalid model to a collection");i=h.cid,j=h.id;if(k[i]||this._byCid[i]||j!=null&&(l[j]||this._byId[j])){m.push(d);continue}k[i]=l[j]=h}d=m.length;while(d--)m[d]=a.splice(m[d],1)[0];for(d=0,g=a.length;d<g;d++)(h=a[d]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id!=null&&(this._byId[h.id]=h);this.length+=g,f=b.at!=null?b.at:this.models.length,c.apply(this.models,[f,0].concat(a));if(b.merge)for(d=0,g=m.length;d<g;d++)(h=this._byId[m[d].id])&&h.set(m[d],b);this.comparator&&b.at==null&&this.sort({silent:!0});if(b.silent)return this;for(d=0,g=this.models.length;d<g;d++){if(!k[(h=this.models[d]).cid])continue;b.index=d,h.trigger("add",h,this,b)}return this},remove:function(a,b){var c,d,f,g;b||(b={}),a=e.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){g=this.getByCid(a[c])||this.get(a[c]);if(!g)continue;delete this._byId[g.id],delete this._byCid[g.cid],f=this.indexOf(g),this.models.splice(f,1),this.length--,b.silent||(b.index=f,g.trigger("remove",g,this,b)),this._removeReference(g)}return this},push:function(a,b){return a=this._prepareModel(a,b),this.add(a,b),a},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return a=this._prepareModel(a,b),this.add(a,e.extend({at:0},b)),a},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){return a==null?void 0:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return e.isEmpty(a)?[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var b=e.bind(this.comparator,this);return this.comparator.length===1?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return e.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]),b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return this._reset(),this.add(a,e.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?e.clone(a):{},a.parse===void 0&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a),c&&c(b,d,a),b.trigger("sync",b,d,a)},a.error=d.wrapError(a.error,b,a),this.sync("read",this,a)},create:function(a,b){var c=this;b=b?e.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;return b.success=function(a,b,e){e.wait&&c.add(a,e),d&&d(a,b,e)},a.save(null,b),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models)},chain:function(){return e(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof h)return a.collection||(a.collection=this),a;b||(b={}),b.collection=this;var c=new this.model(a,b);return c._validate(c.attributes,b)?c:!1},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if(a!=="add"&&a!=="remove"||c===this)a==="destroy"&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],b.id!=null&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments);else return}});var j=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];e.each(j,function(a){i.prototype[a]=function(){return e[a].apply(e,[this.models].concat(e.toArray(arguments)))}});var k=d.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},l=/:\w+/g,m=/\*\w+/g,n=/[-[\]{}()+?.,\\^$|#\s]/g;e.extend(k.prototype,g,{initialize:function(){},route:function(a,b,c){return d.history||(d.history=new o),e.isRegExp(a)||(a=this._routeToRegExp(a)),c||(c=this[b]),d.history.route(a,e.bind(function(e){var f=this._extractParameters(a,e);c&&c.apply(this,f),this.trigger.apply(this,["route:"+b].concat(f)),d.history.trigger("route",this,b,f)},this)),this},navigate:function(a,b){d.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(n,"\\$&").replace(l,"([^/]+)").replace(m,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var o=d.History=function(b){this.handlers=[],e.bindAll(this,"checkUrl"),this.location=b&&b.location||a.location,this.history=b&&b.history||a.history},p=/^[#\/]/,q=/msie [\w.]+/,r=/\/$/;o.started=!1,e.extend(o.prototype,g,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(a==null)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.options.root.replace(r,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();return decodeURIComponent(a.replace(p,""))},start:function(a){if(o.started)throw new Error("Backbone.history has already been started");o.started=!0,this.options=e.extend({},{root:"/"},this.options,a),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var b=this.getFragment(),c=document.documentMode,f=q.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7);r.test(this.options.root)||(this.options.root+="/"),f&&this._wantsHashChange&&(this.iframe=d.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?d.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!f?d.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b;var g=this.location,h=g.pathname.replace(/[^/]$/,"$&/")===this.options.root&&!g.search;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),this.location.replace(this.options.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&g.hash&&(this.fragment=this.getHash().replace(p,""),this.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){d.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),o.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe)));if(b===this.fragment)return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=e.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return c},navigate:function(a,b){if(!o.started)return!1;if(!b||b===!0)b={trigger:b};var c=(a||"").replace(p,"");if(this.fragment===c)return;this.fragment=c;var d=(c.indexOf(this.options.root)!==0?this.options.root:"")+c;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,d);else{if(!this._wantsHashChange)return this.location.assign(d);this._updateHash(this.location,c,b.replace),this.iframe&&c!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))}b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.href.replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});var s=d.View=function(a){this.cid=e.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},t=/^(\S+)\s*(.*)$/,u=["model","collection","el","id","attributes","className","tagName"];e.extend(s.prototype,g,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,b,c){var e=document.createElement(a);return b&&d.$(e).attr(b),c!=null&&d.$(e).html(c),e},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof d.$?a:d.$(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=z(this,"events")))return;this.undelegateEvents();for(var b in a){var c=a[b];e.isFunction(c)||(c=this[a[b]]);if(!c)throw new Error('Method "'+a[b]+'" does not exist');var d=b.match(t),f=d[1],g=d[2];c=e.bind(c,this),f+=".delegateEvents"+this.cid,g===""?this.$el.bind(f,c):this.$el.delegate(g,f,c)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=e.extend({},this.options,a));for(var b=0,c=u.length;b<c;b++){var d=u[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(!this.el){var a=e.extend({},z(this,"attributes"));this.id&&(a.id=z(this,"id")),this.className&&(a["class"]=z(this,"className")),this.setElement(this.make(z(this,"tagName"),a),!1)}else this.setElement(this.el,!1)}});var v=function(a,b){return y(this,a,b)};h.extend=i.extend=k.extend=s.extend=v;var w={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};d.sync=function(a,b,c){var f=w[a];c||(c={});var g={type:f,dataType:"json"};return c.url||(g.url=z(b,"url")||A()),!c.data&&b&&(a==="create"||a==="update")&&(g.contentType="application/json",g.data=JSON.stringify(b)),d.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),d.emulateHTTP&&(f==="PUT"||f==="DELETE")&&(d.emulateJSON&&(g.data._method=f),g.type="POST",g.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",f)}),g.type!=="GET"&&!d.emulateJSON&&(g.processData=!1),d.ajax(e.extend(g,c))},d.ajax=function(){return d.$.ajax.apply(d.$,arguments)},d.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d,a?a(b,e,c):b.trigger("error",b,e,c)}};var x=function(){},y=function(a,b,c){var d;return b&&b.hasOwnProperty("constructor")?d=b.constructor:d=function(){a.apply(this,arguments)},e.extend(d,a),x.prototype=a.prototype,d.prototype=new x,b&&e.extend(d.prototype,b),c&&e.extend(d,c),d.prototype.constructor=d,d.__super__=a.prototype,d},z=function(a,b){return!a||!a[b]?null:e.isFunction(a[b])?a[b]():a[b]},A=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("backbone",["underscore"],function(a){return function(){return a.Backbone}}(this)),function(){function a(){return a}function b(a,d){var f=b.resolve(a),g=b.modules[f];if(!g)throw new Error('failed to require "'+a+'" from '+d);return g.exports||(g.exports={},g.call(g.exports,g,g.exports,b.relative(f),c)),g.exports}var c=this;b.modules={},b.resolve=function(a){var c=a,d=a+".js",e=a+"/index.js";return b.modules[d]&&d||b.modules[e]&&e||c},b.register=function(a,c){b.modules[a]=c},b.relative=function(c){return function(d){if("debug"==d)return a;if("."!=d.charAt(0))return b(d);var f=c.split("/"),g=d.split("/");f.pop();for(var h=0;h<g.length;h++){var i=g[h];".."==i?f.pop():"."!=i&&f.push(i)}return b(f.join("/"),c)}},b.register("engine.io-client.js",function(a,b,c,d){b.version="0.1.0",b.protocol=1,b.util=c("./util"),b.parser=c("./parser"),b.Socket=c("./socket"),b.EventEmitter=c("./event-emitter"),b.Transport=c("./transport"),b.transports=c("./transports")}),b.register("event-emitter.js",function(a,b,c,d){function e(){}function f(a){return"[object Array]"==Object.prototype.toString.call(a)}a.exports=e,e.prototype.on=function(a,b){return this.$events||(this.$events={}),this.$events[a]?f(this.$events[a])?this.$events[a].push(b):this.$events[a]=[this.$events[a],b]:this.$events[a]=b,this},e.prototype.addListener=e.prototype.on,e.prototype.once=function(a,b){function c(){d.removeListener(a,c),b.apply(this,arguments)}var d=this;return c.listener=b,this.on(a,c),this},e.prototype.removeListener=function(a,b){if(this.$events&&this.$events[a]){var c=this.$events[a];if(f(c)){var d=-1;for(var e=0,g=c.length;e<g;e++)if(c[e]===b||c[e].listener&&c[e].listener===b){d=e;break}if(d<0)return this;c.splice(d,1),c.length||delete this.$events[a]}else(c===b||c.listener&&c.listener===b)&&delete this.$events[a]}return this},e.prototype.removeAllListeners=function(a){return a===undefined?(this.$events={},this):(this.$events&&this.$events[a]&&(this.$events[a]=null),this)},e.prototype.listeners=function(a){return this.$events||(this.$events={}),this.$events[a]||(this.$events[a]=[]),f(this.$events[a])||(this.$events[a]=[this.$events[a]]),this.$events[a]},e.prototype.emit=function(a){if(!this.$events)return!1;var b=this.$events[a];if(!b)return!1;var c=Array.prototype.slice.call(arguments,1);if("function"==typeof b)b.apply(this,c);else{if(!f(b))return!1;var d=b.slice();for(var e=0,g=d.length;e<g;e++)d[e].apply(this,c)}return!0},e.prototype.addEventListener=e.prototype.on,e.prototype.removeEventListener=e.prototype.removeListener,e.prototype.dispatchEvent=e.prototype.emit}),b.register("parser.js",function(a,b,c,d){var e=c("./util"),f=b.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},g=e.keys(f),h={type:"error",data:"parser error"};b.encodePacket=function(a){var b=f[a.type];return undefined!==a.data&&(b+=String(a.data)),""+b},b.decodePacket=function(a){var b=a.charAt(0);return Number(b)!=b||!g[b]?h:a.length>1?{type:g[b],data:a.substring(1)}:{type:g[b]}},b.encodePayload=function(a){if(!a.length)return"0:";var c="",d;for(var e=0,f=a.length;e<f;e++)d=b.encodePacket(a[e]),c+=d.length+":"+d;return c},b.decodePayload=function(a){if(a=="")return[h];var c=[],d="",e,f,g;for(var i=0,j=a.length;i<j;i++){var k=a.charAt(i);if(":"!=k)d+=k;else{if(""==d||d!=(e=Number(d)))return[h];f=a.substr(i+1,e);if(d!=f.length)return[h];if(f.length){g=b.decodePacket(f);if(h.type==g.type&&h.data==g.data)return[h];c.push(g)}i+=e,d=""}}return d!=""?[h]:c}}),b.register("socket.js",function(a,b,c,d){function e(a){if("string"==typeof a){var b=h.parseUri(a);a=arguments[1]||{},a.host=b.host,a.secure=b.scheme=="https"||b.scheme=="wss",a.port=b.port||(a.secure?443:80)}a=a||{},this.secure=a.secure||!1,this.host=a.host||a.hostname||"localhost",this.port=a.port||80,this.query=a.query||{},this.query.uid=g(),this.upgrade=!1!==a.upgrade,this.resource=a.resource||"default",this.path=(a.path||"/engine.io").replace(/\/$/,""),this.path+="/"+this.resource+"/",this.forceJSONP=!!a.forceJSONP,this.flashPath=a.flashPath||"",this.transports=a.transports||["polling","websocket","flashsocket"],this.readyState="",this.writeBuffer=[],this.policyPort=a.policyPort||843,this.open()}function f(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function g(){return String(Math.random()).substr(5)+String(Math.random()).substr(5)}var h=c("./util"),i=c("./transports"),j=c("debug")("engine-client:socket"),k=c("./event-emitter");a.exports=e,h.inherits(e,k),e.prototype.createTransport=function(a){j('creating transport "%s"',a);var b=f(this.query);b.transport=a,this.id&&(b.sid=this.id);var c=new i[a]({host:this.host,port:this.port,secure:this.secure,path:this.path,query:b,forceJSONP:this.forceJSONP,flashPath:this.flashPath,policyPort:this.policyPort});return c},e.prototype.open=function(){this.readyState="opening";var a=this.createTransport(this.transports[0]);a.open(),this.setTransport(a)},e.prototype.setTransport=function(a){var b=this;this.transport&&(j("clearing existing transport"),this.transport.removeAllListeners()),this.transport=a,a.on("drain",function(){b.flush()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})},e.prototype.probe=function(a){j('probing transport "%s"',a);var b=this.createTransport(a,{probe:1}),c=this;b.once("open",function(){j('probe transport "%s" opened',a),b.send([{type:"ping",data:"probe"}]),b.once("packet",function(d){if("pong"==d.type&&"probe"==d.data)j('probe transport "%s" pong',a),c.upgrading=!0,c.emit("upgrading",b),j('pausing current transport "%s"',c.transport.name),c.transport.pause(function(){if("closed"==c.readyState||"closing"==c.readyState)return;j("changing transport and sending upgrade packet"),c.emit("upgrade",b),c.setTransport(b),b.send([{type:"upgrade"}]),b=null,c.upgrading=!1,c.flush()});else{j('probe transport "%s" failed',a);var e=new Error("probe error");e.transport=b.name,c.emit("error",e)}})}),b.open(),this.once("close",function(){b&&(j("socket closed prematurely - aborting probe"),b.close(),b=null)}),this.once("upgrading",function(a){b&&a.name!=b.name&&(j('"%s" works - aborting "%s"',a.name,b.name),b.close(),b=null)})},e.prototype.onOpen=function(){j("socket open"),this.readyState="open",this.emit("open"),this.onopen&&this.onopen.call(this),this.flush();if(this.upgrade&&this.transport.pause){j("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}},e.prototype.onPacket=function(a){if("opening"==this.readyState||"open"==this.readyState){j('socket receive: type "%s", data "%s"',a.type,a.data);switch(a.type){case"open":this.onHandshake(h.parseJSON(a.data));break;case"ping":this.sendPacket("pong"),this.setPingTimeout();break;case"error":var b=new Error("server error");b.code=a.data,this.emit("error",b);break;case"message":this.emit("message",a.data);var c={data:a.data};c.toString=function(){return a.data},this.onmessage&&this.onmessage.call(this,c)}}else j('packet received with socket readyState "%s"',this.readyState)},e.prototype.onHandshake=function(a){this.emit("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=a.upgrades,this.pingTimeout=a.pingTimeout,this.onOpen(),this.setPingTimeout()},e.prototype.setPingTimeout=function(){clearTimeout(this.pingTimeoutTimer);var a=this;this.pingTimeoutTimer=setTimeout(function(){a.onClose("ping timeout")},this.pingTimeout)},e.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(j("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.writeBuffer=[])},e.prototype.send=function(a){return this.sendPacket("message",a),this},e.prototype.sendPacket=function(a,b){var c={type:a,data:b};this.writeBuffer.push(c),this.flush()},e.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.onClose("forced close"),j("socket closing - telling transport to close"),this.transport.close();return this},e.prototype.onError=function(a){this.emit("error",a),this.onClose("transport error",a)},e.prototype.onClose=function(a,b){"closed"!=this.readyState&&(j('socket close with reason: "%s"',a),this.readyState="closed",this.emit("close",a,b),this.onclose&&this.onclose.call(this))}}),b.register("transport.js",function(a,b,c,d){function e(a){this.path=a.path,this.host=a.host,this.port=a.port,this.secure=a.secure,this.query=a.query,this.readyState=""}var f=c("./util"),g=c("./parser"),h=c("./event-emitter");a.exports=e,f.inherits(e,h),e.prototype.onError=function(a,b){var c=new Error(a);return c.type="TransportError",c.description=b,this.emit("error",c),this},e.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this},e.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this},e.prototype.send=function(a){if("open"!=this.readyState)throw new Error("Transport not open");this.write(a)},e.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},e.prototype.onData=function(a){this.onPacket(g.decodePacket(a))},e.prototype.onPacket=function(a){this.emit("packet",a)},e.prototype.onClose=function(){this.readyState="closed",this.emit("close")}}),b.register("transports/flashsocket.js",function(a,b,c,d){function e(a){h.call(this,a),this.flashPath=a.flashPath,this.policyPort=a.policyPort}function f(a,b){if(j[a])return b();var c=document.createElement("script"),d=!1;c.onload=c.onreadystatechange=function(){if(d||j[a])return;var e=c.readyState;if(!e||"loaded"==e||"complete"==e)c.onload=c.onreadystatechange=null,d=!0,j[a]=!0,b()},c.async=1,c.src=a;var e=document.getElementsByTagName("head")[0];e.insertBefore(c,e.firstChild)}function g(a,b){function c(d){if(!a[d])return b();f(a[d],function(){c(++d)})}c(0)}var h=c("./websocket"),i=c("../util");a.exports=e,i.inherits(e,h),e.prototype.name="flashsocket",e.prototype.doOpen=function(){function a(a){return function(){var a=Array.prototype.join.call(arguments," ")}}if(!this.check())return;WEB_SOCKET_LOGGER={log:a("debug"),error:a("error")},WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR=!0,WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0,"undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=this.flashPath+"WebSocketMainInsecure.swf");var b=[this.flashPath+"web_socket.js"];"undefined"==typeof swfobject&&b.unshift(this.flashPath+"swfobject.js");var c=this;g(b,function(){c.ready(function(){WebSocket.__addTask(function(){h.prototype.doOpen.call(c)})})})},e.prototype.doClose=function(){if(!this.socket)return;var a=this;WebSocket.__addTask(function(){h.prototype.doClose.call(a)})},e.prototype.write=function(){var a=this,b=arguments;WebSocket.__addTask(function(){h.prototype.write.apply(a,b)})},e.prototype.ready=function(a){function b(){e.loaded||(843!=c.policyPort&&WebSocket.loadFlashPolicyFile("xmlsocket://"+c.host+":"+c.policyPort),WebSocket.__initialize(),e.loaded=!0),a.call(c)}if(!(typeof WebSocket!="undefined"&&"__initialize"in WebSocket)||!swfobject)return;if(swfobject.getFlashPlayerVersion().major<10)return;var c=this;if(document.body)return b();i.load(b)},e.prototype.check=function(){if(typeof WebSocket=="undefined"||"__initialize"in WebSocket){if(window.ActiveXObject){var a=null;try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(b){}if(a)return!0}else for(var c=0,d=navigator.plugins.length;c<d;c++)for(var e=0,f=navigator.plugins[c].length;e<f;e++)if(navigator.plugins[c][e].description=="Shockwave Flash")return!0;return!1}return!1};var j={}}),b.register("transports/index.js",function(a,b,c,d){function e(a){var b=!1;return d.location&&(b=a.host!=d.location.hostname||d.location.port!=a.port),j.request(b)&&!a.forceJSONP?new f(a):new g(a)}var f=c("./polling-xhr"),g=c("./polling-jsonp"),h=c("./websocket"),i=c("./flashsocket"),j=c("../util");b.polling=e,b.websocket=h,b.flashsocket=i}),b.register("transports/polling-jsonp.js",function(a,b,c,d){function e(){}function f(a){g.call(this,a),this.index=k++;var b=this;j.push(function(a){b.onData(a)}),this.query.j=j.length-1}var g=c("./polling"),h=c("../util");a.exports=f;var i=/\n/g,j=d.___eio=[],k=0;h.inherits(f,g),f.prototype.doOpen=function(){var a=this;h.defer(function(){g.prototype.doOpen.call(a)})},f.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null),g.prototype.doClose.call(this)},f.prototype.doPoll=function(){var a=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),a.async=!0,a.src=this.uri();var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b),this.script=a,h.ua.gecko&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},f.prototype.doWrite=function(a,b){function c(){d(),b()}function d(){e.iframe&&e.form.removeChild(e.iframe);try{j=document.createElement('<iframe name="'+e.iframeId+'">')}catch(a){j=document.createElement("iframe"),j.name=e.iframeId}j.id=e.iframeId,e.form.appendChild(j),e.iframe=j}var e=this;if(!this.form){var f=document.createElement("form"),g=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index,j;f.className="socketio",f.style.position="absolute",f.style.top="-1000px",f.style.left="-1000px",f.target=h,f.method="POST",f.setAttribute("accept-charset","utf-8"),g.name="d",f.appendChild(g),document.body.appendChild(f),this.form=f,this.area=g}this.form.action=this.uri(),d(),this.area.value=a.replace(i,"\\n");try{this.form.submit()}catch(k){}this.iframe.attachEvent?j.onreadystatechange=function(){e.iframe.readyState=="complete"&&c()}:this.iframe.onload=c}}),b.register("transports/polling-xhr.js",function(a,b,c,d){function e(){}function f(a){h.call(this,a),d.location&&(this.xd=a.host!=d.location.hostname||d.location.port!=a.port)}function g(a){this.method=a.method||"GET",this.uri=a.uri,this.xd=!!a.xd,this.async=!1!==a.async,this.data=undefined!=a.data?a.data:null,this.create()}var h=c("./polling"),i=c("../event-emitter"),j=c("../util");a.exports=f,a.exports.Request=g,j.inherits(f,h),f.prototype.doOpen=function(){var a=this;j.defer(function(){h.prototype.doOpen.call(a)})},f.prototype.request=function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,new g(a)},f.prototype.doWrite=function(a,b){var c=this.request({method:"POST",data:a}),d=this;c.on("success",b),c.on("error",function(a){d.onError("xhr post error",a)}),this.sendXhr=c},f.prototype.doPoll=function(){var a=this.request(),b=this;a.on("data",function(a){b.onData(a)}),a.on("error",function(a){b.onError("xhr poll error",a)}),this.pollXhr=a},j.inherits(g,i),g.prototype.create=function(){var a=this.xhr=j.request(this.xd),b=this;a.open(this.method,this.uri,this.async);if("POST"==this.method)try{a.setRequestHeader?a.setRequestHeader("Content-type","text/plain;charset=UTF-8"):a.contentType="text/plain"}catch(c){}this.xd&&d.XDomainRequest&&a instanceof XDomainRequest?(a.onerror=function(a){b.onError(a)},a.onload=function(){b.onData(a.responseText)},a.onprogress=e):("withCredentials"in a&&(a.withCredentials=!0),a.onreadystatechange=function(){var c;try{if(4!=a.readyState)return;200==a.status||1223==a.status?c=a.responseText:b.onError(a.status)}catch(d){b.onError(d)}undefined!==c&&b.onData(c)}),a.send(this.data),d.ActiveXObject&&(this.index=g.requestsCount++,g.requests[this.index]=this)},g.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},g.prototype.onData=function(a){this.emit("data",a),this.onSuccess()},g.prototype.onError=function(a){this.emit("error",a),this.cleanup()},g.prototype.cleanup=function(){this.xhr.onreadystatechange=e,this.xhr.onload=this.xhr.onerror=e;try{this.xhr.abort()}catch(a){}d.ActiveXObject&&delete g.requests[this.index],this.xhr=null},g.prototype.abort=function(){this.cleanup()},d.ActiveXObject&&(g.requestsCount=0,g.requests={},d.attachEvent("onunload",function(){for(var a in g.requests)g.requests.hasOwnProperty(a)&&g.requests[a].abort()}))}),b.register("transports/polling.js",function(a,b,c,d){function e(a){f.call(this,a),this.forceBust=!!a.forceBust}var f=c("../transport"),g=c("../util"),h=c("../parser");a.exports=e,g.inherits(e,f),e.prototype.name="polling",e.prototype.doOpen=function(){this.poll()},e.prototype.pause=function(a){function b(){d.readyState="paused",a()}var c=0,d=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(e++,this.once("poll",function(){--e||b()})),this.writable||(e++,this.once("drain",function(){--e||b()}))}else b()},e.prototype.poll=function(){this.polling=!0,this.doPoll()},e.prototype.onData=function(a){var b=h.decodePayload(a);for(var c=0,d=b.length;c<d;c++){"opening"==this.readyState&&this.onOpen();if("close"==b[c].type){this.onClose();return}this.onPacket(b[c])}this.polling=!1,this.emit("poll"),"open"==this.readyState&&this.poll()},e.prototype.doClose=function(){this.send([{type:"close"}])},e.prototype.write=function(a){var b=this;this.writable=!1,this.doWrite(h.encodePayload(a),function(){b.writable=!0,b.emit("drain")})},e.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";if(d.ActiveXObject||this.forceBust)a.t=+(new Date);return a=g.qs(a),this.port&&("https"==b&&this.port!=443||"http"==b&&this.port!=80)&&(c=":"+this.port),a.length&&(a="?"+a),b+"://"+this.host+c+this.path+a}}),b.register("transports/websocket.js",function(a,b,c,d){function e(a){g.call(this,a)}function f(){return d.WebSocket||d.MozWebSocket}var g=c("../transport"),h=c("../parser"),i=c("../util");a.exports=e,i.inherits(e,g),e.prototype.name="websocket",e.prototype.doOpen=function(){if(!this.check())return;var a=this;this.socket=new(f())(this.uri()),this.socket.onopen=function(){a.onOpen()},this.socket.onclose=function(){a.onClose()},this.socket.onmessage=function(b){a.onData(b.data)},this.socket.onerror=function(b){a.onError("websocket error",b)}},e.prototype.write=function(a){for(var b=0,c=a.length;b<c;b++)this.socket.send(h.encodePacket(a[b]))},e.prototype.doClose=function(){typeof this.socket!="undefined"&&this.socket.close()},e.prototype.uri=function(){var a=i.qs(this.query),b=this.secure?"wss":"ws",c="";return this.port&&("wss"==b&&this.port!=443||"ws"==b&&this.port!=80)&&(c=":"+this.port),a.length&&(a="?"+a),b+"://"+this.host+c+this.path+a},e.prototype.check=function(){var a=f();return!!a&&!("__initialize"in a&&this.name===e.prototype.name)}}),b.register("util.js",function(a,b,c,d){var e=!1;b.inherits=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c},b.keys=Object.keys||function(a){var b=[],c=Object.prototype.hasOwnProperty;for(var d in a)c.call(a,d)&&b.push(d);return b},b.on=function(a,b,c,d){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,d)},b.load=function(a){if(d.document&&document.readyState==="complete"||e)return a();b.on(d,"load",a,!1)},"undefined"!=typeof window&&b.load(function(){e=!0}),b.defer=function(a){if(!b.ua.webkit||"undefined"!=typeof importScripts)return a();b.load(function(){setTimeout(a,100)})};var f=/^[\],:{}\s]*$/,g=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,h=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,j=/^\s+/,k=/\s+$/;b.parseJSON=function(a){if("string"!=typeof a||!a)return null;a=a.replace(j,"").replace(k,"");if(d.JSON&&JSON.parse)return JSON.parse(a);if(f.test(a.replace(g,"@").replace(h,"]").replace(i,"")))return(new Function("return "+a))()},b.ua={},b.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var a=new XMLHttpRequest}catch(b){return!1}return a.withCredentials!=undefined}(),b.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),b.ua.gecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent),b.request=function(a){if(a&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;try{if("undefined"!=typeof XMLHttpRequest&&(!a||b.ua.hasCORS))return new XMLHttpRequest}catch(c){}if(!a)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}};var l=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,m=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.parseUri=function(a){var b=l.exec(a||""),c={},d=14;while(d--)c[m[d]]=b[d]||"";return c},b.qs=function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=c+"="+encodeURIComponent(a[c]));return b}}),"undefined"!=typeof module?module.exports=b("engine.io-client"):eio=b("engine.io-client")}(),define("vendor/engine.io",function(a){return function(){return a.eio}}(this)),function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d=[],e={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},f=function(a,b){var c=e,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"; __p.push('"}).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"")+"');}return __p.join('');";return d};define("tpl",[],function(){var e,g,h;return typeof window!="undefined"&&window.navigator&&window.document?g=function(a,b){var c=e.createXhr();c.open("GET",a,!0),c.onreadystatechange=function(a){c.readyState===4&&b(c.responseText)},c.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node&&(h=require.nodeRequire("fs"),g=function(a,b){b(h.readFileSync(a,"utf8"))}),e={version:"0.24.0",strip:function(a){if(a){a=a.replace(b,"");var d=a.match(c);d&&(a=d[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"").replace(/[\t]/g,"").replace(/[\r]/g,"")},createXhr:function(){var b,c,d;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(c=0;c<3;c++){d=a[c];try{b=new ActiveXObject(d)}catch(e){}if(b){a=[d];break}}if(!b)throw new Error("require.getXhr(): XMLHttpRequest not available");return b},get:g,load:function(a,b,c,g){var h=!1,j,k=a.indexOf("."),l=a.substring(0,k),m=a.substring(k+1,a.length);k=m.indexOf("!"),k!==-1&&(h=m.substring(k+1,m.length),h=h==="strip",m=m.substring(0,k)),j="nameToUrl"in b?b.nameToUrl(l,"."+m):b.toUrl(l+"."+m),e.get(j,function(b){b=f(b),g.isBuild||(b=new Function("obj",b)),b=h?e.strip(b):b,g.isBuild&&g.inlineText&&(d[a]=b),c(b)})},write:function(a,b,c){if(b in d){var f=e.jsEscape(d[b]);c("define('"+a+"!"+b+"', function() {return function(obj) { "+f.replace(/(\\')/g,"'").replace(/(\\\\)/g,"\\")+"}});\n")}}}})}(),define("tpl!templates/cell.ejs",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<figure data-id="',id,'">  <img src="',cover_url,'"/>  <div class="progress"></div></figure><div class="controls">  <a href="#" data-action="play" class="icon-play"></a>  <a href="#" data-action="fullscreen" class="icon-fullscreen"></a>  <a href="',hash,'.gif" class="icon-link"></a></div>');return __p.join("")}}),define("plugins/jquery.imagesloaded",[],function(){(function(a,b){var c="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";a.fn.imagesLoaded=function(d){function f(){var b=a(m),c=a(o);i&&(o.length?i.reject(k,b,c):i.resolve(k)),a.isFunction(d)&&d.call(h,k,b,c)}function g(b,d){if(b.src===c||a.inArray(b,l)!==-1)return;l.push(b),d?o.push(b):m.push(b),a.data(b,"imagesLoaded",{isBroken:d,src:b.src}),j&&i.notifyWith(a(b),[d,k,a(m),a(o)]),k.length===l.length&&(setTimeout(f),k.unbind(".imagesLoaded"))}var h=this,i=a.isFunction(a.Deferred)?a.Deferred():0,j=a.isFunction(i.notify),k=h.find("img").add(h.filter("img")),l=[],m=[],o=[];return k.length?k.bind("load.imagesLoaded error.imagesLoaded",function(a){g(a.target,a.type==="error")}).each(function(d,f){var h=f.src,i=a.data(f,"imagesLoaded");if(i&&i.src===h){g(f,i.isBroken);return}if(f.complete&&f.naturalWidth!==b){g(f,f.naturalWidth===0||f.naturalHeight===0);return}if(f.readyState||f.complete)f.src=c,f.src=h}):f(),i?i.promise(h):h}})(jQuery)}),define("cell",["underscore","backbone","tpl!templates/cell.ejs","plugins/jquery.imagesloaded"],function(a,b,c){var d=b.View.extend({tagName:"article",className:"span2",initialize:function(){if(!this.model)throw new Error("You must provide a model");this.model.on("change:cover_url",a.once(this.addToGrid),this),this.model.get("url")?this.backgroundRender():this.model.on("change:url",a.once(this.backgroundRender),this)},updateProgress:function(a){this.$(".progress").css("width",a)},backgroundRender:function(){var a=this.model.get("url"),b=this,c;if(a===undefined)throw new Error("The model needs a url attribute to do this");this.$("img").imagesLoaded(function(){b.full_img=new Image,b.full_img.src=a,b.updateProgress("25%");var d=b.loaded=$(b.full_img).imagesLoaded();d.done(function(){c&&clearTimeout(c),b.updateProgress("100%"),delete b.full_img}),d.progress&&d.progress(function(a){var d=50;b.updateProgress(d+"%");var e=function(){if(d===99)return;b.updateProgress((d+=1)+"%"),c=setTimeout(e,30)}()})})},render:function(){this.$el.html(c(this.model.toJSON()))},addToGrid:function(){var a=this;this.render(),this.$el.imagesLoaded(function(){$("#grid").isotope("insert",a.$el)})},events:{'click [data-action="play"]':"play",'click [data-action="pause"]':"pause",'click [data-action="fullscreen"]':"fullScreen",'click [data-action="delete"]':"destroy","dblclick img":"fullScreen"},fullScreen:function(a){this.is_playing||this.play();var b=Modernizr.prefixed("RequestFullScreen",this.$("img")[0]);return b&&b(),!1},aniMagic:function(a){return this.is_playing?this.pause():this.play()},play:function(a){var b=this.$("img"),c=this.model.get("url");return c===undefined?!1:(b.attr("src",c),this.is_playing=!0,$(a.currentTarget).attr({"data-action":"pause","class":"icon-pause"}),!1)},pause:function(a){var b=this.$("img"),c=this.model.get("cover_url");return c===undefined?!1:(b.attr("src",c),this.is_playing=!1,$(a.currentTarget).attr({"data-action":"play","class":"icon-play"}),!1)},destroy:function(a){var b=this;return this.model.destroy().done(function(){$("#grid").isotope("remove",b.$el,function(){b.remove()})}),!1}});return d}),define("upload",["underscore"],function(a){function b(a){if(!a||!a.collection)throw new Error("Must provide a well-formed view");this.view=a,document.addEventListener("dragenter",function(a){a.preventDefault(),a.stopPropagation()},!1),document.addEventListener("dragover",function(a){a.preventDefault(),a.stopPropagation()},!1);var b=this;document.addEventListener("drop",function(){b.dropHandler.apply(b,arguments)},!1)}return b.prototype.dropHandler=function(b){function c(a){if(!f.test(a.type))return;var b=new FileReader,c=$.Deferred(),e=new FormData;return e.append("files",a),b.onload=function(a){var b=a.target.result,f=new Uint8Array(b),g=f.length,h=0;for(var j=0,k=g-9;j<k&&h<2;j++)f[j]===0&&f[j+1]===33&&f[j+2]===249&&f[j+3]===4&&f[j+8]===0&&(f[j+9]===44||f[j+9]===33)&&h++;if(h<2){c.reject();return}$.ajax({url:"/upload",type:"post",cache:!1,processData:!1,contentType:!1,data:e}).then(function(a){c.resolve(),d.view.collection.add(a)},function(){c.reject()})},b.readAsArrayBuffer(a),c.promise()}b.stopPropagation(),b.preventDefault();var d=this,f=/gif/,g=b.dataTransfer.files;g.length&&$("#loader").addClass("js-show"),$.when.apply(null,a.map(g,c)).always(function(){$("#loader").removeClass("js-show")})},b}),define("grid",["underscore","backbone","cell","upload","plugins/jquery.imagesloaded"],function(a,b,c,d){var e=b.View.extend({el:$("#grid"),initialize:function(a){var b=this;if(!a.socket)throw new Error("You must provide a socket instance");this.socket=a.socket;if(!this.collection)throw new Error("You must provide a collection");this.collection.view=this,this.collection.on("add",function(a){var b=this.collection.getByCid(a.cid);b.view=new c({model:b}),b.get("cover_url")&&b.view.addToGrid()},this),this.collection.fetch().done(function(a){b.collection.each(function(a){var d=b.$('[data-id="'+a.id+'"]');d.length&&(a.view=new c({model:a,el:d.parent()}))}),b.render()}),this.uploader=new d(this)},render:function(){var b=this;b.$el.imagesLoaded(function(){b.$el.isotope({itemSelector:"article",getSortData:{createdAt:function(a){var c=b.collection.get(a.find("figure").data("id"));return-c.get("createdAt")}},sortBy:"createdAt"})});var c=$(window),d=!1;c.on("scroll",a.debounce(function(){!d&&c.scrollTop()+c.height()>=b.$el.height()-300&&(b.collection.current_page+=1,$.getJSON(b.collection.url(),function(a){if(!a.length){b.collection.current_page--,d=!0;return}b.collection.add(a)}))},100))}});return e}),define("media_model",["underscore","backbone"],function(a,b){var c=b.Model.extend({url:function(){return"/api/media/"+this.id},initialize:function(){},update:function(a){var b=$.extend(this.toJSON(),a);this.set(b)}});return c}),function(a){a.deparam=function(b,c){var d={},f={"true":!0,"false":!1,"null":null};return a.each(b.replace(/\+/g," ").split("&"),function(b,g){var h=g.split("="),j=decodeURIComponent(h[0]),k,l=d,m=0,o=j.split("]["),p=o.length-1;/\[/.test(o[0])&&/\]$/.test(o[p])?(o[p]=o[p].replace(/\]$/,""),o=o.shift().split("[").concat(o),p=o.length-1):p=0;if(h.length===2){k=decodeURIComponent(h[1]),c&&(k=k&&!isNaN(k)?+k:k==="undefined"?undefined:f[k]!==undefined?f[k]:k);if(p)for(;m<=p;m++)j=o[m]===""?l.length:o[m],l=l[j]=m<p?l[j]||(o[m+1]&&isNaN(o[m+1])?{}:[]):k;else a.isArray(d[j])?d[j].push(k):d[j]!==undefined?d[j]=[d[j],k]:d[j]=k}else j&&(d[j]=c?undefined:"")}),d}}(jQuery),define("plugins/jquery.deparam",function(){}),define("media_collection",["underscore","backbone","media_model","plugins/jquery.deparam"],function(a,b,c){var d=b.Collection.extend({model:c,url:function(){var a="/api/media";return this.current_page>1&&(a+="?p="+this.current_page),a},initialize:function(){var a=$.deparam(location.search.replace(/^\?/,""));this.current_page=a.p?a.p:1}});return d}),function(a,b,c){var d=a.document,e=a.Modernizr,f=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},g="Moz Webkit O Ms".split(" "),h=function(a){var b=d.documentElement.style,c;if(typeof b[a]=="string")return a;a=f(a);for(var e=0,h=g.length;e<h;e++){c=g[e]+a;if(typeof b[c]=="string")return c}},i=h("transform"),j=h("transitionProperty"),k={csstransforms:function(){return!!i},csstransforms3d:function(){var a=!!h("perspective");if(a){var c=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),d="@media ("+c.join("transform-3d),(")+"modernizr)",e=b("<style>"+d+"{#modernizr{height:3px}}"+"</style>").appendTo("head"),f=b('<div id="modernizr" />').appendTo("html");a=f.height()===3,f.remove(),e.remove()}return a},csstransitions:function(){return!!j}},l;if(e)for(l in k)e.hasOwnProperty(l)||e.addTest(l,k[l]);else{e=a.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var m=" ",n;for(l in k)n=k[l](),e[l]=n,m+=" "+(n?"":"no-")+l;b("html").addClass(m)}if(e.csstransforms){var o=e.csstransforms3d?{translate:function(a){return"translate3d("+a[0]+"px, "+a[1]+"px, 0) "},scale:function(a){return"scale3d("+a+", "+a+", 1) "}}:{translate:function(a){return"translate("+a[0]+"px, "+a[1]+"px) "},scale:function(a){return"scale("+a+") "}},p=function(a,c,d){var e=b.data(a,"isoTransform")||{},f={},g,h={},j;f[c]=d,b.extend(e,f);for(g in e)j=e[g],h[g]=o[g](j);var k=h.translate||"",l=h.scale||"",m=k+l;b.data(a,"isoTransform",e),a.style[i]=m};b.cssNumber.scale=!0,b.cssHooks.scale={set:function(a,b){p(a,"scale",b)},get:function(a,c){var d=b.data(a,"isoTransform");return d&&d.scale?d.scale:1}},b.fx.step.scale=function(a){b.cssHooks.scale.set(a.elem,a.now+a.unit)},b.cssNumber.translate=!0,b.cssHooks.translate={set:function(a,b){p(a,"translate",b)},get:function(a,c){var d=b.data(a,"isoTransform");return d&&d.translate?d.translate:[0,0]}}}var q,r;e.csstransitions&&(q={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd",transitionProperty:"transitionEnd"}[j],r=h("transitionDuration"));var s=b.event,t;s.special.smartresize={setup:function(){b(this).bind("resize",s.special.smartresize.handler)},teardown:function(){b(this).unbind("resize",s.special.smartresize.handler)},handler:function(a,b){var c=this,d=arguments;a.type="smartresize",t&&clearTimeout(t),t=setTimeout(function(){jQuery.event.handle.apply(c,d)},b==="execAsap"?0:100)}},b.fn.smartresize=function(a){return a?this.bind("smartresize",a):this.trigger("smartresize",["execAsap"])},b.Isotope=function(a,c,d){this.element=b(c),this._create(a),this._init(d)};var u=["width","height"],v=b(a);b.Isotope.settings={resizable:!0,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:!1,duration:800},sortBy:"original-order",sortAscending:!0,resizesContainer:!0,transformsEnabled:!b.browser.opera,itemPositionDataEnabled:!1},b.Isotope.prototype={_create:function(a){this.options=b.extend({},b.Isotope.settings,a),this.styleQueue=[],this.elemCount=0;var c=this.element[0].style;this.originalStyle={};var d=u.slice(0);for(var e in this.options.containerStyle)d.push(e);for(var f=0,g=d.length;f<g;f++)e=d[f],this.originalStyle[e]=c[e]||"";this.element.css(this.options.containerStyle),this._updateAnimationEngine(),this._updateUsingTransforms();var h={"original-order":function(a,b){return b.elemCount++,b.elemCount},random:function(){return Math.random()}};this.options.getSortData=b.extend(this.options.getSortData,h),this.reloadItems(),this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var i=this;setTimeout(function(){i.element.addClass(i.options.containerClass)},0),this.options.resizable&&v.bind("smartresize.isotope",function(){i.resize()}),this.element.delegate("."+this.options.hiddenClass,"click",function(){return!1})},_getAtoms:function(a){var b=this.options.itemSelector,c=b?a.filter(b).add(a.find(b)):a,d={position:"absolute"};return this.usingTransforms&&(d.left=0,d.top=0),c.css(d).addClass(this.options.itemClass),this.updateSortData(c,!0),c},_init:function(a){this.$filteredAtoms=this._filter(this.$allAtoms),this._sort(),this.reLayout(a)},option:function(a){if(b.isPlainObject(a)){this.options=b.extend(!0,this.options,a);var c;for(var d in a)c="_update"+f(d),this[c]&&this[c]()}},_updateAnimationEngine:function(){var a=this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,""),b;switch(a){case"css":case"none":b=!1;break;case"jquery":b=!0;break;default:b=!e.csstransitions}this.isUsingJQueryAnimation=b,this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var a=this.usingTransforms=this.options.transformsEnabled&&e.csstransforms&&e.csstransitions&&!this.isUsingJQueryAnimation;a||(delete this.options.hiddenStyle.scale,delete this.options.visibleStyle.scale),this.getPositionStyles=a?this._translate:this._positionAbs},_filter:function(a){var b=this.options.filter===""?"*":this.options.filter;if(!b)return a;var c=this.options.hiddenClass,d="."+c,e=a.filter(d),f=e;if(b!=="*"){f=e.filter(b);var g=a.not(d).not(b).addClass(c);this.styleQueue.push({$el:g,style:this.options.hiddenStyle})}return this.styleQueue.push({$el:f,style:this.options.visibleStyle}),f.removeClass(c),a.filter(b)},updateSortData:function(a,c){var d=this,e=this.options.getSortData,f,g;a.each(function(){f=b(this),g={};for(var a in e)!c&&a==="original-order"?g[a]=b.data(this,"isotope-sort-data")[a]:g[a]=e[a](f,d);b.data(this,"isotope-sort-data",g)})},_sort:function(){var a=this.options.sortBy,b=this._getSorter,c=this.options.sortAscending?1:-1,d=function(d,e){var f=b(d,a),g=b(e,a);return f===g&&a!=="original-order"&&(f=b(d,"original-order"),g=b(e,"original-order")),(f>g?1:f<g?-1:0)*c};this.$filteredAtoms.sort(d)},_getSorter:function(a,c){return b.data(a,"isotope-sort-data")[c]},_translate:function(a,b){return{translate:[a,b]}},_positionAbs:function(a,b){return{left:a,top:b}},_pushPosition:function(a,b,c){b=Math.round(b+this.offset.left),c=Math.round(c+this.offset.top);var d=this.getPositionStyles(b,c);this.styleQueue.push({$el:a,style:d}),this.options.itemPositionDataEnabled&&a.data("isotope-item-position",{x:b,y:c})},layout:function(a,b){var c=this.options.layoutMode;this["_"+c+"Layout"](a);if(this.options.resizesContainer){var d=this["_"+c+"GetContainerSize"]();this.styleQueue.push({$el:this.element,style:d})}this._processStyleQueue(a,b),this.isLaidOut=!0},_processStyleQueue:function(a,c){var d=this.isLaidOut?this.isUsingJQueryAnimation?"animate":"css":"css",f=this.options.animationOptions,g=this.options.onLayout,h,i,j,k;i=function(a,b){b.$el[d](b.style,f)};if(this._isInserting&&this.isUsingJQueryAnimation)i=function(a,b){h=b.$el.hasClass("no-transition")?"css":d,b.$el[h](b.style,f)};else if(c||g||f.complete){var l=!1,m=[c,g,f.complete],n=this;j=!0,k=function(){if(l)return;var b;for(var c=0,d=m.length;c<d;c++)b=m[c],typeof b=="function"&&b.call(n.element,a,n);l=!0};if(this.isUsingJQueryAnimation&&d==="animate")f.complete=k,j=!1;else if(e.csstransitions){var o=0,p=this.styleQueue[0],s=p&&p.$el,t;while(!s||!s.length){t=this.styleQueue[o++];if(!t)return;s=t.$el}var u=parseFloat(getComputedStyle(s[0])[r]);u>0&&(i=function(a,b){b.$el[d](b.style,f).one(q,k)},j=!1)}}b.each(this.styleQueue,i),j&&k(),this.styleQueue=[]},resize:function(){this["_"+this.options.layoutMode+"ResizeChanged"]()&&this.reLayout()},reLayout:function(a){this["_"+this.options.layoutMode+"Reset"](),this.layout(this.$filteredAtoms,a)},addItems:function(a,b){var c=this._getAtoms(a);this.$allAtoms=this.$allAtoms.add(c),b&&b(c)},insert:function(a,b){this.element.append(a);var c=this;this.addItems(a,function(a){var d=c._filter(a);c._addHideAppended(d),c._sort(),c.reLayout(),c._revealAppended(d,b)})},appended:function(a,b){var c=this;this.addItems(a,function(a){c._addHideAppended(a),c.layout(a),c._revealAppended(a,b)})},_addHideAppended:function(a){this.$filteredAtoms=this.$filteredAtoms.add(a),a.addClass("no-transition"),this._isInserting=!0,this.styleQueue.push({$el:a,style:this.options.hiddenStyle})},_revealAppended:function(a,b){var c=this;setTimeout(function(){a.removeClass("no-transition"),c.styleQueue.push({$el:a,style:c.options.visibleStyle}),c._isInserting=!1,c._processStyleQueue(a,b)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function(a,b){var c=this,d=function(){c.$allAtoms=c.$allAtoms.not(a),a.remove(),b&&b.call(c.element)};a.filter(":not(."+this.options.hiddenClass+")").length?(this.styleQueue.push({$el:a,style:this.options.hiddenStyle}),this.$filteredAtoms=this.$filteredAtoms.not(a),this._sort(),this.reLayout(d)):d()},shuffle:function(a){this.updateSortData(this.$allAtoms),this.options.sortBy="random",this._sort(),this.reLayout(a)},destroy:function(){var a=this.usingTransforms,b=this.options;this.$allAtoms.removeClass(b.hiddenClass+" "+b.itemClass).each(function(){var b=this.style;b.position="",b.top="",b.left="",b.opacity="",a&&(b[i]="")});var c=this.element[0].style;for(var d in this.originalStyle)c[d]=this.originalStyle[d];this.element.unbind(".isotope").undelegate("."+b.hiddenClass,"click").removeClass(b.containerClass).removeData("isotope"),v.unbind(".isotope")},_getSegments:function(a){var b=this.options.layoutMode,c=a?"rowHeight":"columnWidth",d=a?"height":"width",e=a?"rows":"cols",g=this.element[d](),h,i=this.options[b]&&this.options[b][c]||this.$filteredAtoms["outer"+f(d)](!0)||g;h=Math.floor(g/i),h=Math.max(h,1),this[b][e]=h,this[b][c]=i},_checkIfSegmentsChanged:function(a){var b=this.options.layoutMode,c=a?"rows":"cols",d=this[b][c];return this._getSegments(a),this[b][c]!==d},_masonryReset:function(){this.masonry={},this._getSegments();var a=this.masonry.cols;this.masonry.colYs=[];while(a--)this.masonry.colYs.push(0)},_masonryLayout:function(a){var c=this,d=c.masonry;a.each(function(){var a=b(this),e=Math.ceil(a.outerWidth(!0)/d.columnWidth);e=Math.min(e,d.cols);if(e===1)c._masonryPlaceBrick(a,d.colYs);else{var f=d.cols+1-e,g=[],h,i;for(i=0;i<f;i++)h=d.colYs.slice(i,i+e),g[i]=Math.max.apply(Math,h);c._masonryPlaceBrick(a,g)}})},_masonryPlaceBrick:function(a,b){var c=Math.min.apply(Math,b),d=0;for(var e=0,f=b.length;e<f;e++)if(b[e]===c){d=e;break}var g=this.masonry.columnWidth*d,h=c;this._pushPosition(a,g,h);var i=c+a.outerHeight(!0),j=this.masonry.cols+1-f;for(e=0;e<j;e++)this.masonry.colYs[d+e]=i},_masonryGetContainerSize:function(){var a=Math.max.apply(Math,this.masonry.colYs);return{height:a}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function(a){var c=this,d=this.element.width(),e=this.fitRows;a.each(function(){var a=b(this),f=a.outerWidth(!0),g=a.outerHeight(!0);e.x!==0&&f+e.x>d&&(e.x=0,e.y=e.height),c._pushPosition(a,e.x,e.y),e.height=Math.max(e.y+g,e.height),e.x+=f})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return!0},_cellsByRowReset:function(){this.cellsByRow={index:0},this._getSegments(),this._getSegments(!0)},_cellsByRowLayout:function(a){var c=this,d=this.cellsByRow;a.each(function(){var a=b(this),e=d.index%d.cols,f=Math.floor(d.index/d.cols),g=(e+.5)*d.columnWidth-a.outerWidth(!0)/2,h=(f+.5)*d.rowHeight-a.outerHeight(!0)/2;c._pushPosition(a,g,h),d.index++})},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.$filteredAtoms.length/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.offset.top}},_cellsByRowResizeChanged:function(){return this._checkIfSegmentsChanged()},_straightDownReset:function(){this.straightDown={y:0}},_straightDownLayout:function(a){var c=this;a.each(function(a){var d=b(this);c._pushPosition(d,0,c.straightDown.y),c.straightDown.y+=d.outerHeight(!0)})},_straightDownGetContainerSize:function(){return{height:this.straightDown.y}},_straightDownResizeChanged:function(){return!0},_masonryHorizontalReset:function(){this.masonryHorizontal={},this._getSegments(!0);var a=this.masonryHorizontal.rows;this.masonryHorizontal.rowXs=[];while(a--)this.masonryHorizontal.rowXs.push(0)},_masonryHorizontalLayout:function(a){var c=this,d=c.masonryHorizontal;a.each(function(){var a=b(this),e=Math.ceil(a.outerHeight(!0)/d.rowHeight);e=Math.min(e,d.rows);if(e===1)c._masonryHorizontalPlaceBrick(a,d.rowXs);else{var f=d.rows+1-e,g=[],h,i;for(i=0;i<f;i++)h=d.rowXs.slice(i,i+e),g[i]=Math.max.apply(Math,h);c._masonryHorizontalPlaceBrick(a,g)}})},_masonryHorizontalPlaceBrick:function(a,b){var c=Math.min.apply(Math,b),d=0;for(var e=0,f=b.length;e<f;e++)if(b[e]===c){d=e;break}var g=c,h=this.masonryHorizontal.rowHeight*d;this._pushPosition(a,g,h);var i=c+a.outerWidth(!0),j=this.masonryHorizontal.rows+1-f;for(e=0;e<j;e++)this.masonryHorizontal.rowXs[d+e]=i},_masonryHorizontalGetContainerSize:function(){var a=Math.max.apply(Math,this.masonryHorizontal.rowXs);return{width:a}},_masonryHorizontalResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0}},_fitColumnsLayout:function(a){var c=this,d=this.element.height(),e=this.fitColumns;a.each(function(){var a=b(this),f=a.outerWidth(!0),g=a.outerHeight(!0);e.y!==0&&g+e.y>d&&(e.x=e.width,e.y=0),c._pushPosition(a,e.x,e.y),e.width=Math.max(e.x+f,e.width),e.y+=g})},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResizeChanged:function(){return!0},_cellsByColumnReset:function(){this.cellsByColumn={index:0},this._getSegments(),this._getSegments(!0)},_cellsByColumnLayout:function(a){var c=this,d=this.cellsByColumn;a.each(function(){var a=b(this),e=Math.floor(d.index/d.rows),f=d.index%d.rows,g=(e+.5)*d.columnWidth-a.outerWidth(!0)/2,h=(f+.5)*d.rowHeight-a.outerHeight(!0)/2;c._pushPosition(a,g,h),d.index++})},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.$filteredAtoms.length/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth}},_cellsByColumnResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_straightAcrossReset:function(){this.straightAcross={x:0}},_straightAcrossLayout:function(a){var c=this;a.each(function(a){var d=b(this);c._pushPosition(d,c.straightAcross.x,0),c.straightAcross.x+=d.outerWidth(!0)})},_straightAcrossGetContainerSize:function(){return{width:this.straightAcross.x}},_straightAcrossResizeChanged:function(){return!0}},b.fn.imagesLoaded=function(a){function c(){a.call(e,f)}function d(a){var e=a.target;e.src!==h&&b.inArray(e,i)===-1&&(i.push(e),--g<=0&&(setTimeout(c),f.unbind(".imagesLoaded",d)))}var e=this,f=e.find("img").add(e.filter("img")),g=f.length,h="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",i=[];return g||c(),f.bind("load.imagesLoaded error.imagesLoaded",d).each(function(){var a=this.src;this.src=h,this.src=a}),e};var w=function(b){a.console&&a.console.error(b)};b.fn.isotope=function(a,c){if(typeof a=="string"){var d=Array.prototype.slice.call(arguments,1);this.each(function(){var c=b.data(this,"isotope");if(!c){w("cannot call methods on isotope prior to initialization; attempted to call method '"+a+"'");return}if(!b.isFunction(c[a])||a.charAt(0)==="_"){w("no such method '"+a+"' for isotope instance");return}c[a].apply(c,d)})}else this.each(function(){var d=b.data(this,"isotope");d?(d.option(a),d._init(c)):b.data(this,"isotope",new b.Isotope(a,this,c))});return this}}(window,jQuery),define("plugins/jquery.isotope",function(){}),require(["underscore","backbone","vendor/engine.io","grid","media_collection","upload","plugins/jquery.isotope"],function(a,b,c,d,e,f){var g=new c.Socket({host:location.hostname,port:location.port});$(function(){Modernizr.touch&&scrollTo(0,1);var a=new e,b=window.Grid=new d({socket:g,collection:a});g.on("message",function(b){b=JSON.parse(b);var c=a.get(b.id);c?c.update(b):a.add(b)})})}),define("main",function(){}),require.config({deps:["main"],paths:{vendor:"../assets/js/vendor",plugins:"../assets/js/plugins",backbone:"../assets/js/vendor/backbone",underscore:"../assets/js/vendor/lodash",tpl:"../assets/js/plugins/tpl",text:"../assets/js/plugins/text",json:"../assets/js/plugins/json"},shim:{backbone:{exports:"Backbone",deps:["underscore"]},"vendor/engine.io":{exports:"eio"},"plugins/jquery.deparam":[],"plugins/jquery.isotope":[]}}),define("config",function(){});